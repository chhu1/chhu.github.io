<!DOCTYPE html>
<html>

<head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>微信demo</title>
</head>

<body>
    <script type="text/javascript">
    function WebChat() {
        this.init();
    }
    WebChat.prototype = {
        init: function() {
            this.weixin_share.addWXScript();
        },
        weixin_share: {
            addWXScript: function() { //引入js文件
                var self = this;
                var existScript = document.body.getElementsByTagName('script')[0];
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'http://res.wx.qq.com/open/js/jweixin-1.0.0.js';
                document.body.insertBefore(script, existScript);
                script.onload = function() {
                    var jsApiList = ['onMenuShareAppMessage', 'onMenuShareTimeline'],
                        title = '我的分享',
                        link = 'https://www.baidu.com',
                        desc = '我的分享',
                        imgUrl = 'http://dev.s.56qq.cn/staticBase/src/images/iconShare.jpg',
                        config = {
                            appid: 'wx07b8a4072e3e19f0',
                            timestamp: 1467798570,
                            noncestr: 'Wm3WZYTPz0wzccnW',
                            signature: '4a5f5e61a2d083e13cc311bd9e5ebba19b899469'
                        };
                    self.wx_config(config.appid, config.timestamp, config.noncestr, config.signature, jsApiList);
                    wx.ready(function() {
                        self.wx_shareTimeline(title, link, imgUrl);
                        self.wx_shareAppMessage(title, desc, link, imgUrl);
                        self.wx_onMenuShareQQ(title, desc, link, imgUrl);
                    });
                }
            },
            wx_config: function(appId, timestamp, nonceStr, signature, jsApiList) {
                wx.config({
                    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                    appId: appId, // 必填，公众号的唯一标识
                    timestamp: timestamp, // 必填，生成签名的时间戳
                    nonceStr: nonceStr, // 必填，生成签名的随机串
                    signature: signature, // 必填，签名，见附录1
                    jsApiList: jsApiList
                });
            },
            wx_shareTimeline: function(title, link, imgUrl) {
                wx.onMenuShareTimeline({
                    title: desc, // 分享标题
                    link: link, // 分享链接
                    imgUrl: imgUrl, // 分享图标
                    success: function() {},
                    cancel: function() {}
                });
            },
            wx_shareAppMessage: function(title, desc, link, imgUrl) {
                wx.onMenuShareAppMessage({
                    title: title, // 分享标题
                    desc: desc, // 分享描述
                    link: link, // 分享链接
                    imgUrl: imgUrl, // 分享图标
                    type: '', // 分享类型,music、video或link，不填默认为link
                    dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                    success: function() {},
                    cancel: function() {}
                });
            },
            wx_onMenuShareQQ: function(title, desc, link, imgUrl) {
                wx.onMenuShareQQ({
                    title: title, // 分享标题
                    desc: desc, // 分享描述
                    link: link, // 分享链接
                    imgUrl: imgUrl, // 分享图标
                    success: function() {
                        // 用户确认分享后执行的回调函数
                    },
                    cancel: function() {
                        // 用户取消分享后执行的回调函数
                    }
                });
            }
        }
    };
    var webchat = new WebChat();
    </script>
</body>
</html>
